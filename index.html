<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Verifikasi reCAPTCHA</title>
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>
<body>
  <h2>Verifikasi reCAPTCHA</h2>
  <form id="verifyForm">
    <div class="g-recaptcha" data-sitekey="6LdbSIArAAAAAF1zDt-gVZtU3RhIyb7algKArnXP"></div>
    <br>
    <button type="submit">Verifikasi</button>
  </form>

  <div id="result"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
    import { getFunctions, httpsCallable } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-functions.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDeiLybtGc6evATj5O7M1FiJd1GPYd-rYc",
      authDomain: "tamplatedoc.firebaseapp.com",
      projectId: "tamplatedoc",
      appId: "1:264966107720:web:868abe93cdff209040de7d",
    };

    const app = initializeApp(firebaseConfig);
    const functions = getFunctions(app);
    const verifyRecaptcha = httpsCallable(functions, "verifyRecaptcha");

    const form = document.getElementById("verifyForm");
    const resultDiv = document.getElementById("result");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const token = grecaptcha.getResponse();

      if (!token) {
        resultDiv.textContent = "Silakan selesaikan reCAPTCHA.";
        return;
      }

      resultDiv.textContent = "Memverifikasi...";

      try {
        const result = await verifyRecaptcha({ token });
        resultDiv.textContent = "Berhasil diverifikasi ✅";
        grecaptcha.reset(); // Reset agar bisa diverifikasi ulang
      } catch (error) {
        console.error(error);
        resultDiv.textContent = "Verifikasi gagal ❌: " + (error.message || error.code);
        grecaptcha.reset();
      }
    });
  </script>
</body>
</html>

